<?= $this->extend('layouts/base.html') ?>

<?= $this->section('contents') ?>
<div class="container-fluid">
  <?= h1_title(lang('App.func.user'), lang('App.index')) ?>
  <?= $this->include('layouts/alert/success.html') ?>
  <?= $this->include('layouts/alert/error.html') ?>
  <div class="card my-1">
    <?= form_open('', ['method' => 'get']) ?>
    <div class="card-body">
      <div class="my-2">
        <?= form_input([
          'class' => 'form-control',
          'name' => 'text',
          'placeholder' => lang('App.user.searchTextPlaceholder'),
          'value' => $params['text'] ?? '',
        ]) ?>
      </div>
    </div>
    <div class="card-footer">
      <div class="my-1">
        <button class="btn btn-primary">
          <i class="fas fa-search"></i>
          <?= lang('App.search') ?>
        </button>
        <?= anchor('/users', lang('App.reset'), 'class="btn btn-secondary"') ?>
      </div>
    </div>
    <?= form_close() ?>
  </div>
  <div class="my-2">
    <?= anchor('/users/new', '<i class="fas fa-edit"></i>' . lang('App.new'), 'class="btn btn-link"') ?>
  </div>
  <div class="d-flex flex-column flex-sm-row justify-content-sm-between">
    <div class="my-2">
      <p>
        <?= $user->total ?>
      </p>
    </div>
    <div class="my-2">
      <?= $user->pager->links() ?>
    </div>
  </div>
  <table class="table table-bordered table-light">
    <thead class="table-light">
      <tr>
        <th scope="col">
        </th>
        <th scope="col">
          <?= anchor_sort('/users', $params, 'email', lang('App.user.email')) ?>
        </th>
        <th scope="col">
          <?= anchor_sort('/users', $params, 'name', lang('App.user.name')) ?>
        </th>
        <th scope="col">
          <?= anchor_sort('/users', $params, 'createdAt', lang('App.createdAt')) ?>
        </th>
        <th scope="col">
          <?= anchor_sort('/users', $params, 'updatedAt', lang('App.updatedAt')) ?>
        </th>
      </tr>
    </thead>
    <tbody>
      <? foreach($user->items as $item) : ?>
      <tr>
        <td scope="row">
          <?= anchor('/users/' . $item->id, '<i class="fas fa-edit"></i>') ?>
        </td>
        <td>
          <?= $item->email ?>
        </td>
        <td>
          <?= \esc($item->name) ?>
        </td>
        <td>
          <?= $item->created_at ?>
        </td>
        <td>
          <?= $item->updated_at ?>
        </td>
      </tr>
      <? endforeach; ?>
    </tbody>
  </table>
</div>
<?= $this->endSection() ?>
